policy: sync

serviceMonitor:
  enabled: true

extraVolumes:
- name: conf
  hostPath:
    path: /mnt/data/conf/dnsmasq/

sources:
  - service
  - ingress
  - crd
  - gateway-httproute

provider:
  name: webhook
  webhook:
    imagePullPolicy: Always
    image:
      repository: localhost:5000/e_d
      tag: "test12"
    args:
    - --domain-name
    - magicloud.lan
    - --conf-filename
    - /etc/dnsmasq.d/external.conf
    env:
    - name: RUST_LOG
      value: debug
    - name: OTEL_EXPORTER_OTLP_ENDPOINT
      # In various places, this value is written without "http://". That does not work.
      value: http://alloy.monitoring.svc.cluster.local:4317
    - name: OTEL_EXPORTER_OTLP_INSECURE
      value: "true"
    - name: OTEL_EXPORTER_OTLP_PROTOCOL
      value: grpc
    extraVolumeMounts:
    - name: conf
      mountPath: /etc/dnsmasq.d/
